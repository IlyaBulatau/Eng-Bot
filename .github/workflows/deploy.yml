name: Deploy Bot
env:
  ENV_FILE: ".env.prod"
  REPO: "https://github.com/IlyaBulatau/Eng-Bot.git"

on:
  workflow_run:
    workflows: ["Testing Bot"]
    branches: ["main"]
    types: [completed]

jobs: 
  build_and_deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Check out repository
        uses: actions/checkout@v2
        
      - name: Clone repositoy
        uses: garygrossgarten/github-action-ssh@release
        with:
          host: ${{ secrets.IP_SERVER }}
          username: ${{ secrets.LOGIN_SERVER }}
          password: ${{ secrets.PASSWORD_SERVER }}
          command: |
              cd ..
              cd home/
              mkdir -p code
              cd code/
              git clone ${{ env.REPO }}
